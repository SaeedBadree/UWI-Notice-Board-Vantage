<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>UWI Notice Board</title>
  <link href="static/css/page.css" rel="stylesheet" type="text/css" />
  <link href="static/css/form.css" rel="stylesheet" type="text/css" />
  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
</head>

<script>
  function selectedOption() {
    selected = document.getElementByID("faculty").value;
    alert(selected);
  }
</script>

<body>

  <header class="header">
    <div class="logo left">
      <a href="{{ url_for('home') }}">
        <h3>UWI Notice Board</h3>
      </a>
    </div>

    <div class="search center">
      <form method="POST" action="{{ url_for('search') }}" class="d-flex">
        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" name="searchCriteria" />
        <button class="btn btn-outline-secondary" type="submit"><i class="material-icons">search</i></button>
      </form>
    </div>

    <div class="icons-right"></div>
  </header>
  <main>
    <div class="side-bar">
      <div class="nav">
        <a href="{{ url_for('home') }}" class="nav-link">
          <i class="material-icons">home</i>
          <span>Home</span>
        </a>

        <a href="{{ url_for('feed', uID = current_user.id, sortF = None, sortD = None) }}" class="nav-link">
          <i class="material-icons">explore</i>
          <span>Feed</span>
        </a>

        <a href="{{ url_for('boards') }}" class="nav-link active">
          <i class="material-icons">collections</i>
          <span>Boards</span>
        </a>

        <a href="{{ url_for('cal') }}" class="nav-link">
          <i class="material-icons">date_range</i>
          <span>Calendar</span>
        </a>
      </div>

      <hr>

      <div>
        <h4>-Username-</h4>

        <button onclick="window.location.href='/logout'">Log Out</button>

        <a href="" class="nav-link">
          <i class="material-icons">collections_bookmark</i>
          <span>Saved Boards</span>
        </a>
        
        <a href="{{ url_for('logout') }}" class="nav-link">
          <i class="material-icons">logout</i>
          <span>Logout</span>
        </a>
      </div>
    </div>
    {% block content %}
    {% if formPost %}
    <div class="container-post">
      <h4>Please fill out the form to create your post</h4><br />
      <form method="POST" enctype="multipart/form-data" style="width:100%">
        {{ formPost.hidden_tag() }}
        <div class="card">
          <div class="card-left">
            <div class="card-top" style="height:200vh">
              <div class="top-left">
                <div class="profile-image">
                  <img src="static/images/defaultProfile.jpg" alt="">
                  <p class="name">Aaron S.</p>
                  <p class="time">1hr ago</p>
                </div>
              </div>
              <div class="top-right">
                <div class="card-content">
                  <h3 class="title">{{ formPost.title(placeholder="Enter post title") }}</h3>
                  <p>{{ formPost.message(placeholder="Add some text") }}</p>
                </div>

                <div class="card-content">
                  <label for="eventCheck">Create Event</label>
                  <input type="checkBox" id="eventCheck" onclick="scheduleEvent()">

                  <div id="eventDrop" style="display:none">
                    <p>{{ formPost.startDate.label}} {{formPost.startDate(class='DateTimeField')}}</p>
                    <p>{{ formPost.endDate.label}} {{formPost.endDate(class='DateTimeField')}}</p>
                  </div><br>

                  <br>
                  
                  <label for="postCheck">Schedule Post</label>
                  <input type="checkBox" id="postCheck" onclick="schedulePost()">

                  <div id="postDrop" style="display:none">
                    <p>{{ formPost.schedulePostDate.label}} {{formPost.schedulePostDate(class='form-control')}}</p>
                  </div><br>

                  <br>

                  <label for="deleteCheck">Schedule Delete</label>
                  <input type="checkBox" id="deleteCheck" onclick="scheduleDelete()">

                  <div id="deleteDrop" style="display:none">
                    <p>{{ formPost.scheduledDeleteDate.label}} {{formPost.scheduledDeleteDate(class='form-control')}}</p>
                  </div><br>

                  <br>
                    <script>
                      function scheduleEvent() {
                        var box = document.getElementById("eventCheck");
                        var drop = document.getElementById("eventDrop");

                        if (box.checked) {
                          drop.style.display = "block";
                        }
                        else {
                          drop.style.display = "none";
                        }
                      }

                      function schedulePost() {
                        var box = document.getElementById("postCheck");
                        var drop = document.getElementById("postDrop");

                        if (box.checked) {
                          drop.style.display = "block";
                        }
                        else {
                          drop.style.display = "none";
                        }
                      }

                      function scheduleDelete() {
                        var box = document.getElementById("deleteCheck");
                        var drop = document.getElementById("deleteDrop");

                        if (box.checked) {
                          drop.style.display = "block";
                        }
                        else {
                          drop.style.display = "none";
                        }
                      }
                    </script>
                </div>
              </div>
            </div>
            <div class="card-bot">
              <div class="card-bot-left">
                <p class="board-name">DCIT</p>
              </div>
              <div class="card-bot-mid">
                <div class="card-footer">
                  <button>{{ formPost.submit() }}</button>
                </div>
              </div>
            </div>
          </div>
          <div class="card-right">
            <div class="flyer">
              {% if file_url %}
              <img class="flyer-image" src="{{ url_for('get_file', filename=formPost.photo)  }}" alt="">
              {% endif %}
            </div>
          </div>
        </div>
        {{ formPost.photo(class="form.control") }}
      </form>
      {{ ckeditor.load(pkg_type="basic") }}
      {{ ckeditor.config(name='message') }}
    </div>

    {% else %}

    <div class="container-board">
      <h4>Please fill out the form to create your board</h4><br />
      <!-- Need to allow user to add in faculty and department here -->
      <form method="POST" enctype="multipart/form-data" style="width:100%">
        <div class="board-card">
          <div class="board-card-image">
            <img src="static/images/dark.jpg">
          </div>
          <div class="board-card-content">
            <div class="board-title">
              <h3>
                {{ formBoard.hidden_tag() }}
                {{ formBoard.title(placeholder="Enter board name") }}
              </h3>
            </div>
            <div class="board-left-card">
              <div class="board-u-count">
                <p class="board-users-count">1.2k</p>
              </div>
              <div class="board-user-icon">
                <i class="material-icons">person</i>
              </div>
            </div>
          </div>
          <div class="board-join">
            <button>{{ formBoard.submit() }}</button>
          </div>
        </div>

        <select name='faculty'>
          {% for fac in faculty %}
          <option value="{{ fac.label }}" {% set value=fac.label + "+" + "None" %} {% if value==choice %} selected {%
            elif choice is none and fac.label=="STA" %} selected {% endif %}>
            {{ fac.title }}
          </option>

          {% if department | selectattr('fLabel','equalto', fac.label) | list | length > 1 %}
          <optgroup label="Departments:">
            {% for dept in department %}
            {% if dept.department != "" and fac.label == dept.fLabel%}
            <option value="{{ fac.label }}+{{ dept.dLabel }}" {% set value=fac.label + "+" + dept.dLabel %} {% if
              value==choice %} selected {% endif %}>
              {{ dept.department }}
            </option>
            {% endif %}
            {% endfor %}
          </optgroup>
          {% endif %}

          {% endfor %}
        </select>

        {{ formBoard.photo(class="form.control") }}
        <br>

      </form>
      {{ ckeditor.load(pkg_type="basic") }}
      {{ ckeditor.config(name='message') }}
    </div>
    {% endif %}
    {% endblock %}
  </main>
  <script src="script.js">
  </script>
</body>

</html>